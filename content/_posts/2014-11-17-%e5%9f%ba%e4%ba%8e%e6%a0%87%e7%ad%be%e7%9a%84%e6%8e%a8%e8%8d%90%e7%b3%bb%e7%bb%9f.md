---
title: 基于标签的推荐系统
author: luosha865
layout: post
date: 2014-11-17
url: /archives/5
posturl_add_url:
  - yes
categories:
  - 机器学习
tags:
  - 推荐系统
---
一、基于图模型的推荐

在不考虑标签时，基于二项图有两种随机游走的图推荐算法：

1.probability spreading

随机游走算法，在游走中，每个目标得到权重是基于归属者的边计算出来的。

每次传播(item->user->item)后用户Ui的兴趣向量：

<p class="ql-center-displayed-equation" style="line-height: 51px;">
  <span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-72578d7b8cd811343615a8e13fcdbe2a_l3.png" height="51" width="259" class="ql-img-displayed-equation quicklatex-auto-format" alt="&#92;&#91;&#102;&#95;&#106;&#94;&#112;&#61;&#92;&#115;&#117;&#109;&#95;&#123;&#108;&#61;&#49;&#125;&#94;&#123;&#110;&#125;&#92;&#115;&#117;&#109;&#95;&#123;&#115;&#61;&#49;&#125;&#94;&#123;&#109;&#125;&#92;&#102;&#114;&#97;&#99;&#123;&#97;&#95;&#123;&#108;&#106;&#125;&#97;&#95;&#123;&#108;&#115;&#125;&#97;&#95;&#123;&#105;&#115;&#125;&#125;&#123;&#75;&#40;&#85;&#95;&#108;&#41;&#75;&#40;&#73;&#95;&#115;&#41;&#125;&#44;&#106;&#61;&#49;&#8230;&#109;&#92;&#93;" title="Rendered by QuickLaTeX.com" />
</p>

2.heat spreading

规则与ProbS相反，在游走中，每个目标得到权重是基于自己的边计算出来的。

每次传播后用户Ui的兴趣向量：

<p class="ql-center-displayed-equation" style="line-height: 51px;">
  <span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-b0998856c4f20c869185526c6f2d5dab_l3.png" height="51" width="281" class="ql-img-displayed-equation quicklatex-auto-format" alt="&#92;&#91;&#102;&#95;&#104;&#94;&#112;&#61;&#92;&#102;&#114;&#97;&#99;&#123;&#49;&#125;&#123;&#75;&#40;&#73;&#95;&#106;&#41;&#125;&#92;&#115;&#117;&#109;&#95;&#123;&#108;&#61;&#49;&#125;&#94;&#123;&#110;&#125;&#92;&#115;&#117;&#109;&#95;&#123;&#115;&#61;&#49;&#125;&#94;&#123;&#109;&#125;&#92;&#102;&#114;&#97;&#99;&#123;&#97;&#95;&#123;&#108;&#106;&#125;&#97;&#95;&#123;&#108;&#115;&#125;&#97;&#95;&#123;&#105;&#115;&#125;&#125;&#123;&#75;&#40;&#85;&#95;&#108;&#41;&#125;&#44;&#106;&#61;&#49;&#8230;&#109;&#92;&#93;" title="Rendered by QuickLaTeX.com" />
</p>

其中：<img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-b079522ca48af5742d3a92fad1cab60e_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#75;&#40;&#73;&#95;&#106;&#41;&#61;&#92;&#115;&#117;&#109;&#95;&#123;&#108;&#61;&#49;&#125;&#94;&#123;&#109;&#125;&#97;&#95;&#123;&#108;&#106;&#125;" title="Rendered by QuickLaTeX.com" height="20" width="133" style="vertical-align: -6px;" />是节目j的邻域大小，<img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-c00cedda4e5d5763a770835d673ba5c5_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#75;&#40;&#85;&#95;&#108;&#41;&#61;&#92;&#115;&#117;&#109;&#95;&#123;&#108;&#61;&#49;&#125;&#94;&#123;&#110;&#125;&#97;&#95;&#123;&#108;&#115;&#125;" title="Rendered by QuickLaTeX.com" height="20" width="135" style="vertical-align: -6px;" />是用户l的邻域大小。

<img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-8b434a5adf074f8f0e25a42236e0c3ed_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#97;&#95;&#123;&#105;&#106;&#125;" title="Rendered by QuickLaTeX.com" height="14" width="20" style="vertical-align: -6px;" />是表示用户i和物品j之间是否有边存在的二元向量。

相比之下，Heats算法倾向于降低热门item的权重，而Probs中与增强对热门item的推荐。

&nbsp;

在随机游走算法的基础上，有基于<span style="color: #333333; font-family: arial; font-size: 13px; line-height: 20.0200004577637px;">三分图的标签推荐算法：</span>

<img title="NewImage.png" src="http://images.cnitblog.com/blog/52809/201411/171255254884996.png" alt="NewImage" width="600" height="305" border="0" />

图中，用户i的每个item的权重（1 or 0）会同时像用户和标签进行传播，这样每次传播后的兴趣向量：

<img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-f78f41f2bf011c73a4bffd5e2472a3fe_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#102;&#95;&#106;&#94;&#116;&#61;&#92;&#108;&#97;&#109;&#98;&#100;&#97;&#32;&#102;&#95;&#106;&#94;&#112;&#32;&#43;&#32;&#40;&#49;&#45;&#92;&#108;&#97;&#109;&#98;&#100;&#97;&#41;&#32;&#102;&#95;&#106;&#94;&#123;&#112;&#116;&#125;" title="Rendered by QuickLaTeX.com" height="26" width="168" style="vertical-align: -8px;" />，其中<img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-2bde2cec73738ac0234706257f6dc449_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#102;&#95;&#106;&#94;&#112;" title="Rendered by QuickLaTeX.com" height="23" width="18" style="vertical-align: -8px;" />和<img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-71804ecfd1421a8904e2c9a4305983d6_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#102;&#95;&#106;&#94;&#123;&#112;&#116;&#125;" title="Rendered by QuickLaTeX.com" height="26" width="23" style="vertical-align: -8px;" />分别是从(item->user->item)和(item->tag->item)传播后得到的权重。

<span style="font-size: 14px;">二、矩阵分解的张量模型</span>

对三元阵<img src="http://blog.sword865.com/wp-content/ql-cache/quicklatex.com-067fe9c87c45494d6cab789cc05de1e9_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#89;&#95;&#123;&#40;&#110;&#92;&#116;&#105;&#109;&#101;&#115;&#32;&#109;&#92;&#116;&#105;&#109;&#101;&#115;&#32;&#116;&#41;&#125;" title="Rendered by QuickLaTeX.com" height="19" width="66" style="vertical-align: -7px;" />进行矩阵分解，C为核张量，U,I,T为用户特征，物品特征和标签特征矩阵。

根据分解结果对Y进行填充。

<img title="NewImage.png" src="http://images.cnitblog.com/blog/52809/201411/171508548949009.png" alt="NewImage" width="600" height="260" border="0" />

填充后即得到评分矩阵

<span style="font-size: 14px;"> </span>

<p style="margin:0;padding:0;height:1px;overflow:hidden;">
  <a href="http://www.wumii.com/widget/relatedItems" style="border:0;"><img src="http://static.wumii.cn/images/pixel.png" alt="无觅相关文章插件，快速提升流量" style="border:0;padding:0;margin:0;" /></a>
</p>